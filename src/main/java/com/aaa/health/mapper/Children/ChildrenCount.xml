<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aaa.health.mapper.Children.ChildrenCount">


    <!-- 分页获取用户列表 -->
    <select id="findList" parameterType="Map" resultType="com.aaa.health.entity.Children.ChildInfo">
        select
        <if test="areaId == 410000">
            '河南' aName
        </if>
        <if test="areaId != 410000">
            area.areaName aName
        </if>
       ,count(userId) anum,(select count(userId)   from userinfo
        join  addnewborn  on userinfo.userId=addnewborn.recordId where 1=1 <if test="recordUnit == 410000">
        and 1=1
    </if>
        <if test="recordUnit != 410000">
            and recordUnit=#{recordUnit}
        </if>) adnumn
        from userinfo join area on userinfo.recordUnit=area.areaId
        where (date_format(CURDATE(),'%Y')-DATE_FORMAT(userinfo.userBirthday,'%Y')) BETWEEN 0 and 6

    <if test="areaId == 410000">
        and 1=1
    </if>
    <if test="areaId != 410000">
        and areaId=#{areaId}
    </if>


    <if test="offset != null and pageSize != null">
        limit #{offset},#{pageSize}
    </if>
</select>

    <select id="getTotal" parameterType="Map" resultType="Integer">
        select count(*) from (select area.areaName 地区,count(userId) anum,(select count(userId) from userinfo
        join addnewborn on userinfo.userId=addnewborn.recordId where 1=1<if test="recordUnit == 410000">
        and 1=1
    </if>
        <if test="recordUnit != 410000">
            and recordUnit=#{recordUnit}
        </if>) adnumn
        from userinfo join area on userinfo.recordUnit=area.areaId
        where (date_format(CURDATE(),'%Y')-DATE_FORMAT(userinfo.userBirthday,'%Y')) BETWEEN 0 and 6

        <if test="areaId == 410000">
            and 1=1
        </if>
        <if test="areaId != 410000">
            and areaId=#{areaId}
        </if>
        <if test="offset != null and pageSize != null">
            limit #{offset},#{pageSize}
        </if>
        ) Children
    </select>



</mapper>